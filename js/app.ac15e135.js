(function(){"use strict";var e={5809:function(e,t,i){var a=i(9242),r=i(3396);function l(e,t,i,a,l,o){const n=(0,r.up)("EzLoading");return(0,r.wg)(),(0,r.j4)(n)}var o=i(7139);const n={class:"d-flex"},s={class:"d-flex flex-column"};function d(e,t,i,l,d,c){const u=(0,r.up)("v-app-bar-nav-icon"),m=(0,r.up)("truck-dialog"),h=(0,r.up)("add-dialog"),g=(0,r.up)("v-app-bar-title"),f=(0,r.up)("v-app-bar"),p=(0,r.up)("v-sheet"),b=(0,r.up)("v-btn"),v=(0,r.up)("v-col"),y=(0,r.up)("v-row"),k=(0,r.up)("v-container"),x=(0,r.up)("v-navigation-drawer"),w=(0,r.up)("v-main"),I=(0,r.up)("v-layout"),W=(0,r.up)("v-rect"),S=(0,r.up)("pallet-konva-group"),C=(0,r.up)("v-layer"),G=(0,r.up)("v-stage");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(I,null,{default:(0,r.w5)((()=>[(0,r.Wm)(f,{color:"primary"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{onClick:t[0]||(t[0]=(0,a.iM)((e=>d.drawer=!d.drawer),["stop"]))}),(0,r._)("div",n,[(0,r.Wm)(m,{customClasses:"ma-2 px-4",variantStyle:"outlined",customColor:"white",mobileOrDesktop:this.displayWidth,customStyle:{backgroundColor:"green"},onLoadSpaceSet:c.loadSpaceSet},null,8,["mobileOrDesktop","onLoadSpaceSet"]),(0,r.Wm)(h,{customClasses:"ma-2 px-4",variantStyle:"outlined",customColor:"white",mobileOrDesktop:this.displayWidth,customStyle:{backgroundColor:"green"},onCargoAdded:c.addCargo},null,8,["mobileOrDesktop","onCargoAdded"])]),(0,r.Wm)(g,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Ez-Loading")])),_:1})])),_:1}),(0,r.Wm)(x,{modelValue:d.drawer,"onUpdate:modelValue":t[1]||(t[1]=e=>d.drawer=e),location:"left",temporary:""},{default:(0,r.w5)((()=>[(0,r._)("div",s,[(0,r.Wm)(p,{class:"ma-2"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{blockStyle:!0,mobileOrDesktop:"desktop",onLoadSpaceSet:c.loadSpaceSet},null,8,["onLoadSpaceSet"])])),_:1}),(0,r.Wm)(p,{class:"ma-2"},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{blockStyle:!0,mobileOrDesktop:"desktop",onCargoAdded:c.addCargo},null,8,["onCargoAdded"])])),_:1}),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.generateNavDrawerList,(e=>((0,r.wg)(),(0,r.j4)(k,{class:"ma-2",key:e.title},{default:(0,r.w5)((()=>[(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[(0,r.Wm)(v,{cols:"2","align-self":"center",class:"ma-0 pa-0",style:{userSelect:"none"}},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{variant:"tonal",density:"compact",icon:"mdi-trash-can-outline",color:"primary",onClick:t=>c.deleteCargoCategory(e),onTap:t=>c.deleteCargoCategory(e)},null,8,["onClick","onTap"])])),_:2},1024),(0,r.Wm)(v,{cols:"5","align-self":"center",class:"ma-0 pa-0",style:{userSelect:"none"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.zw)(e.title),1)])),_:2},1024),(0,r.Wm)(v,{cols:"2","align-self":"center",class:"ma-0 pa-0",style:{userSelect:"none"}},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{variant:"tonal",density:"compact",icon:"mdi-minus",color:"primary",onClick:t=>c.deleteCargoCategoryItem(e),onTap:t=>c.deleteCargoCategoryItem(e)},null,8,["onClick","onTap"])])),_:2},1024),(0,r.Wm)(v,{cols:"1","align-self":"center",class:"ma-0 pa-0",style:{userSelect:"none"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.zw)(e.value.length),1)])),_:2},1024),(0,r.Wm)(v,{cols:"2","align-self":"center",class:"ma-0 pa-0",style:{userSelect:"none"}},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{variant:"tonal",density:"compact",icon:"mdi-plus",color:"primary",onClick:t=>c.addCargo(e["value"][0]["units"],e["value"][0]["dimx"],e["value"][0]["dimy"]),onTap:t=>c.addCargo(e["value"][0]["units"],e["value"][0]["dimx"],e["value"][0]["dimy"])},null,8,["onClick","onTap"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])])),_:1},8,["modelValue"]),(0,r.Wm)(w,{id:"container",class:"d-flex align-center justify-center"})])),_:1}),(0,r.Wm)(G,{ref:"stage",config:d.stageConfig},{default:(0,r.w5)((()=>[(0,r.Wm)(C,{onMousemove:c.handleMouseMove,onPointerdown:c.handlePointerDown,onDragstart:c.handleDragStart,onDragmove:c.handleDragMove,onDragend:c.handleDragEnd,ref:"layer"},{default:(0,r.w5)((()=>[(0,r.Wm)(W,{truckId:"leftWall",config:{id:"truckWall",x:this.truck.originx,y:this.truck.originy,width:10,height:"Imperial"===this.truck.units?this.truck.dimy*this.scaleFactor:.3937*this.truck.dimy*this.scaleFactor,fill:"black"}},null,8,["config"]),(0,r.Wm)(W,{truckId:"backWall",config:{id:"truckWall",x:this.truck.originx+10,y:this.truck.originy,width:"Imperial"===this.truck.units?this.truck.dimx*this.scaleFactor:.3937*this.truck.dimx*this.scaleFactor,height:10,fill:"black"}},null,8,["config"]),(0,r.Wm)(W,{truckId:"rightWall",config:{id:"truckWall",x:"Imperial"===this.truck.units?this.truck.originx+this.truck.dimx*this.scaleFactor+10:this.truck.originx+.3937*this.truck.dimx*this.scaleFactor+10,y:this.truck.originy,width:10,height:"Imperial"===this.truck.units?this.truck.dimy*this.scaleFactor:.3937*this.truck.dimy*this.scaleFactor,fill:"black"}},null,8,["config"]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(d.cargo,((e,t)=>((0,r.wg)(),(0,r.j4)(S,{key:e.id,truck:this.truck,item:e,index:t,scaleFactor:this.scaleFactor,lowestYBound:this.lowestYBound(),onDeleteCargo:i=>c.deleteCargo(e,t),onRotateCargo:i=>c.rotateCargo(e,t)},null,8,["truck","item","index","scaleFactor","lowestYBound","onDeleteCargo","onRotateCargo"])))),128))])),_:1},8,["onMousemove","onPointerdown","onDragstart","onDragmove","onDragend"])])),_:1},8,["config"])],64)}i(7658);var c=i(8157),u=i(4806);function m(e,t,i,l,o,n){const s=(0,r.up)("v-btn"),d=(0,r.up)("v-card-title"),c=(0,r.up)("v-select"),u=(0,r.up)("v-col"),m=(0,r.up)("v-row"),h=(0,r.up)("v-text-field"),g=(0,r.up)("v-container"),f=(0,r.up)("v-form"),p=(0,r.up)("v-spacer"),b=(0,r.up)("v-card-actions"),v=(0,r.up)("v-card"),y=(0,r.up)("v-dialog");return(0,r.wg)(),(0,r.j4)(y,{modelValue:o.dialog,"onUpdate:modelValue":t[11]||(t[11]=e=>o.dialog=e),width:l.displayWidth},{activator:(0,r.w5)((({props:e})=>["desktop"===i.mobileOrDesktop?((0,r.wg)(),(0,r.j4)(s,(0,r.dG)({key:0,"prepend-icon":"mdi-forklift",color:i.customColor,class:i.customClasses,block:i.blockStyle,variant:i.variantStyle,style:i.customStyle},e),{default:(0,r.w5)((()=>[(0,r.Uk)(" Add Cargo ")])),_:2},1040,["color","class","block","variant","style"])):((0,r.wg)(),(0,r.j4)(s,(0,r.dG)({key:1,icon:"mdi-forklift",color:i.customColor,class:"my-2",block:i.blockStyle},e),null,16,["color","block"]))])),default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,{class:"text-h5"},{default:(0,r.w5)((()=>[(0,r.Uk)(" Add Cargo ")])),_:1}),(0,r.Wm)(f,{ref:"addCargoForm",onSubmit:(0,a.iM)(n.onSubmit,["prevent"])},{default:(0,r.w5)((()=>[(0,r.Wm)(g,null,{default:(0,r.w5)((()=>[(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(c,{label:"Select Metric (cm) or Imperial (in) Units",modelValue:o.selectedUnits,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.selectedUnits=e),t[1]||(t[1]=e=>n.newUnitSelected())],items:o.unitChoice,"item-title":"desc","item-value":"unit","return-object":""},null,8,["modelValue","items"])])),_:1})])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,{modelValue:o.dimx,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dimx=e),onChange:t[3]||(t[3]=e=>o.dimx=Number.parseFloat(o.dimx).toFixed(2).toString()),label:"Metric"===this.selectedUnits.unit?"Width (cm)":"Width (in)",suffix:"Metric"===this.selectedUnits.unit?"cm":"in",rules:o.dimRules,"validate-on":"input"},null,8,["modelValue","label","suffix","rules"])])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,{modelValue:o.dimy,"onUpdate:modelValue":t[4]||(t[4]=e=>o.dimy=e),onChange:t[5]||(t[5]=e=>o.dimy=Number.parseFloat(o.dimy).toFixed(2).toString()),label:"Metric"===this.selectedUnits.unit?"Length (cm)":"Length (in)",suffix:"Metric"===this.selectedUnits.unit?"cm":"in",rules:o.dimRules},null,8,["modelValue","label","suffix","rules"])])),_:1})])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>["Metric"===o.selectedUnits.unit?((0,r.wg)(),(0,r.j4)(c,{key:0,label:"Metric Pallet Sizes (centimetres)",modelValue:o.metricPallet,"onUpdate:modelValue":[t[6]||(t[6]=e=>o.metricPallet=e),t[7]||(t[7]=e=>n.newMetricPalletSelected())],items:o.metricPalletSizes,"item-title":"desc","item-value":"tuple","return-object":""},null,8,["modelValue","items"])):((0,r.wg)(),(0,r.j4)(c,{key:1,label:"Imperial Pallet Sizes (inches)",modelValue:o.imperialPallet,"onUpdate:modelValue":[t[8]||(t[8]=e=>o.imperialPallet=e),t[9]||(t[9]=e=>n.newImperialPalletSelected())],items:o.imperialPalletSizes,"item-title":"desc","item-value":"tuple","return-object":""},null,8,["modelValue","items"]))])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"]),(0,r.Wm)(b,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p),(0,r.Wm)(s,{color:"success",onClick:n.onSubmit},{default:(0,r.w5)((()=>[(0,r.Uk)(" Submit ")])),_:1},8,["onClick"]),(0,r.Wm)(s,{color:"error",onClick:t[10]||(t[10]=e=>o.dialog=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)(" Cancel ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","width"])}var h={customColor:"",customClasses:"",blockStyle:!1,variantStyle:"",customStyle:"",mobileOrDesktop:"desktop",props:{customColor:String,customClasses:String,blockStyle:Boolean,variantStyle:String,customStyle:Object,mobileOrDesktop:String},setup(){const{name:e}=(0,c.AW)(),t=(0,r.Fl)((()=>{switch(e.value){case"xs":case"sm":return"100vw";case"md":case"lg":case"xl":case"xxl":return"40vw";default:return"100vw"}}));return{displayWidth:t}},data(){return{dimRules:[e=>!!e||"Dimension is required.",e=>!isNaN(e)&&!isNaN(parseFloat(e))||"Dimension must be a number."],selectedUnits:{desc:"Imperial (inches)",unit:"Imperial"},unitChoice:[{desc:"Metric (centimetres)",unit:"Metric"},{desc:"Imperial (inches)",unit:"Imperial"}],metricPallet:{desc:"EUR 1 80cm x 120cm",tuple:["80.00","120.00"]},metricPalletSizes:[{desc:"EUR 1 80cm x 120cm",tuple:["80.00","120.00"]},{desc:"EUR 2 120cm x 100cm",tuple:["120.00","100.00"]},{desc:"EUR 3 100cm x 120cm",tuple:["100.00","120.00"]},{desc:"EUR 6 80cm x 60cm",tuple:["80.00","60.00"]}],imperialPallet:{desc:'48" x 40"',tuple:["48.00","40.00"]},imperialPalletSizes:[{desc:'48" x 40"',tuple:["48.00","40.00"]},{desc:'42" x 42"',tuple:["42.00","42.00"]},{desc:'48" x 48"',tuple:["48.00","48.00"]}],dimx:"48.00",dimy:"40.00",dialog:!1}},methods:{newUnitSelected(){"Metric"===this.selectedUnits.unit?(this.dimx=this.metricPallet.tuple[0],this.dimy=this.metricPallet.tuple[1]):(this.dimx=this.imperialPallet.tuple[0],this.dimy=this.imperialPallet.tuple[1])},newMetricPalletSelected(){this.dimx=this.metricPallet.tuple[0],this.dimy=this.metricPallet.tuple[1]},newImperialPalletSelected(){this.dimx=this.imperialPallet.tuple[0],this.dimy=this.imperialPallet.tuple[1]},onSubmit(){this.$emit("cargo-added",this.selectedUnits.unit,this.dimx,this.dimy),this.$refs.addCargoForm.resetValidation(),this.dialog=!1}}},g=i(89);const f=(0,g.Z)(h,[["render",m],["__scopeId","data-v-4bf83775"]]);var p=f;function b(e,t,i,l,o,n){const s=(0,r.up)("v-btn"),d=(0,r.up)("v-card-title"),c=(0,r.up)("v-select"),u=(0,r.up)("v-col"),m=(0,r.up)("v-row"),h=(0,r.up)("v-text-field"),g=(0,r.up)("v-container"),f=(0,r.up)("v-form"),p=(0,r.up)("v-spacer"),b=(0,r.up)("v-card-actions"),v=(0,r.up)("v-card"),y=(0,r.up)("v-dialog");return(0,r.wg)(),(0,r.j4)(y,{modelValue:o.dialog,"onUpdate:modelValue":t[11]||(t[11]=e=>o.dialog=e),width:l.displayWidth},{activator:(0,r.w5)((({props:e})=>["desktop"===i.mobileOrDesktop?((0,r.wg)(),(0,r.j4)(s,(0,r.dG)({key:0,"prepend-icon":"mdi-truck-outline",color:i.customColor,class:i.customClasses,block:i.blockStyle,variant:i.variantStyle,style:i.customStyle},e),{default:(0,r.w5)((()=>[(0,r.Uk)(" Set Loading Space ")])),_:2},1040,["color","class","block","variant","style"])):((0,r.wg)(),(0,r.j4)(s,(0,r.dG)({key:1,icon:"mdi-truck-outline",color:i.customColor,class:"my-2",block:i.blockStyle},e),null,16,["color","block"]))])),default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,{class:"text-h5"},{default:(0,r.w5)((()=>[(0,r.Uk)(" Set Loading Space ")])),_:1}),(0,r.Wm)(f,{ref:"setTruckSizeForm",onSubmit:(0,a.iM)(n.onSubmit,["prevent"])},{default:(0,r.w5)((()=>[(0,r.Wm)(g,null,{default:(0,r.w5)((()=>[(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(c,{label:"Select Metric (cm) or Imperial (in) Units",modelValue:o.selectedUnits,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.selectedUnits=e),t[1]||(t[1]=e=>n.newUnitSelected())],items:o.unitChoice,"item-title":"desc","item-value":"unit","return-object":""},null,8,["modelValue","items"])])),_:1})])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,{modelValue:o.dimx,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dimx=e),onChange:t[3]||(t[3]=e=>o.dimx=Number.parseFloat(o.dimx).toFixed(2).toString()),label:"Metric"===this.selectedUnits.unit?"Width (cm)":"Width (in)",suffix:"Metric"===this.selectedUnits.unit?"cm":"in",rules:o.dimRules,"validate-on":"input"},null,8,["modelValue","label","suffix","rules"])])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,{modelValue:o.dimy,"onUpdate:modelValue":t[4]||(t[4]=e=>o.dimy=e),onChange:t[5]||(t[5]=e=>o.dimy=Number.parseFloat(o.dimy).toFixed(2).toString()),label:"Metric"===this.selectedUnits.unit?"Length (cm)":"Length (in)",suffix:"Metric"===this.selectedUnits.unit?"cm":"in",rules:o.dimRules},null,8,["modelValue","label","suffix","rules"])])),_:1})])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>["Metric"===o.selectedUnits.unit?((0,r.wg)(),(0,r.j4)(c,{key:0,label:"Loading Spaces (centimetres)",modelValue:o.metricLoadingSpace,"onUpdate:modelValue":[t[6]||(t[6]=e=>o.metricLoadingSpace=e),t[7]||(t[7]=e=>n.newMetricPalletSelected())],items:o.metricLoadingSpaceSizes,"item-title":"desc","item-value":"tuple","return-object":""},null,8,["modelValue","items"])):((0,r.wg)(),(0,r.j4)(c,{key:1,label:"Loading Spaces (inches)",modelValue:o.imperialLoadingSpace,"onUpdate:modelValue":[t[8]||(t[8]=e=>o.imperialLoadingSpace=e),t[9]||(t[9]=e=>n.newImperialPalletSelected())],items:o.imperialLoadingSpaceSizes,"item-title":"desc","item-value":"tuple","return-object":""},null,8,["modelValue","items"]))])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"]),(0,r.Wm)(b,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p),(0,r.Wm)(s,{color:"success",onClick:n.onSubmit},{default:(0,r.w5)((()=>[(0,r.Uk)(" Submit ")])),_:1},8,["onClick"]),(0,r.Wm)(s,{color:"error",onClick:t[10]||(t[10]=e=>o.dialog=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)(" Cancel ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","width"])}var v={customColor:"",customClasses:"",blockStyle:!1,variantStyle:"",customStyle:"",mobileOrDesktop:"desktop",props:{customColor:String,customClasses:String,blockStyle:Boolean,variantStyle:String,customStyle:Object,mobileOrDesktop:String},setup(){const{name:e}=(0,c.AW)(),t=(0,r.Fl)((()=>{switch(e.value){case"xs":case"sm":return"100vw";case"md":case"lg":case"xl":case"xxl":return"40vw";default:return"100vw"}}));return{displayWidth:t}},data(){return{dimRules:[e=>!!e||"Dimension is required.",e=>!isNaN(e)&&!isNaN(parseFloat(e))||"Dimension must be a number."],selectedUnits:{desc:"Imperial (inches)",unit:"Imperial"},unitChoice:[{desc:"Metric (centimetres)",unit:"Metric"},{desc:"Imperial (inches)",unit:"Imperial"}],metricLoadingSpace:{desc:"Box Trailer 246cm x 1350cm",tuple:["246.00","1350.00"]},metricLoadingSpaceSizes:[{desc:"Box Trailer 246cm x 1350cm",tuple:["246.00","1350.00"]},{desc:"Mega Trailer 247cm x 1360cm",tuple:["247.00","1360.00"]},{desc:"Refridgerated Trailer 249cm x 1341cm",tuple:["249.00","1341.00"]},{desc:"Single Truck Unit 250cm x 800cm",tuple:["250.00","800.00"]}],imperialLoadingSpace:{desc:'Flatbed Trailer 102" (8.5ft) x 576" (48ft)',tuple:["102.00","576.00"]},imperialLoadingSpaceSizes:[{desc:'Flatbed Trailer 102" (8.5ft) x 576" (48ft)',tuple:["102.00","576.00"]},{desc:'Flatbed Trailer 96" (8ft) x 576" (48ft)',tuple:["96.00","576.00"]},{desc:'Container Chassis 102" (8.5ft) x 240" (48ft)',tuple:["102.00","240.00"]},{desc:'Container Chassis 96" (8ft) x 240" (48ft)',tuple:["96.00","240.00"]}],dimx:"102.00",dimy:"576.00",dialog:!1}},methods:{newUnitSelected(){"Metric"===this.selectedUnits.unit?(this.dimx=this.metricLoadingSpace.tuple[0],this.dimy=this.metricLoadingSpace.tuple[1]):(this.dimx=this.imperialLoadingSpace.tuple[0],this.dimy=this.imperialLoadingSpace.tuple[1])},newMetricPalletSelected(){this.dimx=this.metricLoadingSpace.tuple[0],this.dimy=this.metricLoadingSpace.tuple[1]},newImperialPalletSelected(){this.dimx=this.imperialLoadingSpace.tuple[0],this.dimy=this.imperialLoadingSpace.tuple[1]},onSubmit(){this.$emit("load-space-set",this.selectedUnits.unit,this.dimx,this.dimy),this.$refs.setTruckSizeForm.resetValidation(),this.dialog=!1}}};const y=(0,g.Z)(v,[["render",b],["__scopeId","data-v-41d7d97d"]]);var k=y;function x(e,t,i,a,l,o){const n=(0,r.up)("v-rect"),s=(0,r.up)("v-text"),d=(0,r.up)("v-line"),c=(0,r.up)("v-group");return(0,r.wg)(),(0,r.j4)(c,{ref:"cargoGroupRef",config:{id:"cargoGroup",draggable:!0},cargoId:i.item.id},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{config:{id:"cargoGroup",x:0,y:0,width:"Imperial"===i.item.units?i.item.dimx*i.scaleFactor:Math.floor(.3937*i.item.dimx*i.scaleFactor),height:"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:Math.floor(.3937*i.item.dimy*i.scaleFactor),fill:"yellow",strokeWidth:1,stroke:"black"}},null,8,["config"]),(0,r.Wm)(s,{config:{x:0,y:0,text:`${i.item.id}\n${i.item.dimx}${"Imperial"===i.item.units?"in":"cm"} x ${i.item.dimy}${"Imperial"===i.item.units?"in":"cm"}`,fontFamily:"Georgia",fontSize:7*i.scaleFactor,fill:"black",wrap:"none",width:"Imperial"===i.item.units?Math.max(50*i.scaleFactor,i.item.dimx*i.scaleFactor):Math.max(50*i.scaleFactor,.3937*i.item.dimx*i.scaleFactor),height:"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:.3937*i.item.dimy*i.scaleFactor,align:"center",verticalAlign:"middle"}},null,8,["config"]),(0,r.Wm)(n,{onTap:t[0]||(t[0]=t=>e.$emit("deleteCargo",i.item,i.index)),onClick:t[1]||(t[1]=t=>e.$emit("deleteCargo",i.item,i.index)),onMouseover:o.mouseoverPointer,onMouseout:o.mouseoutPointer,config:{x:0,y:0,width:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor):Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor),height:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor):Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor),fillPatternImage:this.closeIcon,fillPatternScaleX:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor)/16:Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor)/16,fillPatternScaleY:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor)/16:Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor)/16}},null,8,["onMouseover","onMouseout","config"]),(0,r.Wm)(n,{onTap:t[2]||(t[2]=t=>e.$emit("rotateCargo",i.item,i.index)),onClick:t[3]||(t[3]=t=>e.$emit("rotateCargo",i.item,i.index)),onMouseover:o.mouseoverPointer,onMouseout:o.mouseoutPointer,config:{x:"Imperial"===i.item.units?i.item.dimx*i.scaleFactor-Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor):.3937*i.item.dimx*i.scaleFactor-Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor),y:0,width:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor):Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor),height:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor):Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor),fillPatternImage:l.rotateIcon,fillPatternScaleX:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor)/16:Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor)/16,fillPatternScaleY:"Imperial"===i.item.units?Math.max(16,i.item.dimx*i.item.dimy*.005*i.scaleFactor)/16:Math.max(16,.3937*i.item.dimx*i.item.dimy*.3937*.005*i.scaleFactor)/16}},null,8,["onMouseover","onMouseout","config"]),(0,r.Wm)(d,{config:{id:"topBorder",points:[0,0,"Imperial"===i.item.units?i.item.dimx*i.scaleFactor:.3937*i.item.dimx*i.scaleFactor,0],strokeWidth:2,stroke:"black",shadowColor:"red",shadowBlur:10,shadowEnabled:!1}},null,8,["config"]),(0,r.Wm)(d,{config:{id:"bottomBorder",points:[0,"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:.3937*i.item.dimy*i.scaleFactor,"Imperial"===i.item.units?i.item.dimx*i.scaleFactor:.3937*i.item.dimx*i.scaleFactor,"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:.3937*i.item.dimy*i.scaleFactor],strokeWidth:2,stroke:"black",shadowColor:"red",shadowBlur:10,shadowEnabled:!1}},null,8,["config"]),(0,r.Wm)(d,{config:{id:"leftBorder",points:[0,0,0,"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:.3937*i.item.dimy*i.scaleFactor],strokeWidth:2,stroke:"black",shadowColor:"red",shadowBlur:10,shadowEnabled:!1}},null,8,["config"]),(0,r.Wm)(d,{config:{id:"rightBorder",points:["Imperial"===i.item.units?i.item.dimx*i.scaleFactor:.3937*i.item.dimx*i.scaleFactor,0,"Imperial"===i.item.units?i.item.dimx*i.scaleFactor:.3937*i.item.dimx*i.scaleFactor,"Imperial"===i.item.units?i.item.dimy*i.scaleFactor:.3937*i.item.dimy*i.scaleFactor],strokeWidth:2,stroke:"black",shadowColor:"red",shadowBlur:10,shadowEnabled:!1}},null,8,["config"])])),_:1},8,["cargoId"])}var w={props:{item:Object,index:Number,truck:Object,scaleFactor:Number,lowestYBound:Number},mounted(){var e=new Image;e.src="close.jpg",e.onload=()=>{this.closeIcon=e};var t=new Image;t.src="rotate.jpg",t.onload=()=>{this.rotateIcon=t},0==this.index?(this.$refs.cargoGroupRef.getNode().x(this.truck.originx+11),this.$refs.cargoGroupRef.getNode().y(this.truck.originy+11)):(this.$refs.cargoGroupRef.getNode().x(this.truck.originx+11),this.$refs.cargoGroupRef.getNode().y(this.lowestYBound))},data(){return{closeIcon:null,rotateIcon:null}},methods:{mouseoverPointer(){document.body.style.cursor="pointer"},mouseoutPointer(){document.body.style.cursor="default"}}};const I=(0,g.Z)(w,[["render",x]]);var W=I;function S(e,t){let i=0;for(let a=0;a<t.length;a++){let r=e.findIndex((e=>e[0].attrs.cargoId===t[a][0].attrs.cargoId));r>=0?(e[r]=t[a],i=r):e.splice(i+1,0,t[a])}}function C(e,t,i,a,r){var l=e[1],o=e[2],n=!(a>l+t.width||a+i.width<l||r>o+t.height||r+i.height<o),s=a+i.width/2,d=r+i.height/2,c=l+t.width/2,u=o+t.height/2,m=c-s,h=u-d,g=Math.abs(m)>Math.abs(h)?m:0,f=Math.abs(m)<=Math.abs(h)?h:0,p={intersectionResult:n,transform:{x:g,y:f}};return p}function G(e,t,i,a){var r=(e,t,i,a,r)=>!(a>e.x()+t.width||a+i.width-1<e.x()||r>e.y()+t.height||r+i.height-1<e.y()),l=e.findOne("Rect").getClientRect(),o=a.find((e=>"leftWall"===e.attrs.truckId)),n=a.find((e=>"backWall"===e.attrs.truckId)),s=a.find((e=>"rightWall"===e.attrs.truckId)),d="isNotWall",c="isNotWall",u=!!n&&{left:n.x?.(),right:n.x?.()+n.width?.(),top:n.y?.(),bottom:n.y?.()+n.height?.()},m=!!o&&{left:o.x?.(),right:o.x?.()+o.width?.(),top:o.y?.(),bottom:o.y?.()+o.height?.()},h=!!s&&{left:s.x?.(),right:s.x?.()+s.width?.(),top:s.y?.(),bottom:s.y?.()+s.height?.()},g={left:t,right:t+l.width,top:i,bottom:i+l.height};function f(e,t){var i=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return i*a}var p=[u?f(u,g):0,m?f(m,g):0,h?f(h,g):0];if(0==Math.max(...p))c="isNotWall";else switch(p.findIndex((e=>e==Math.max(...p)))){case 0:c="backWall";break;case 1:c="leftWall";break;case 2:c="rightWall";break;default:c="isNotWall"}var b=!!o&&r(o,o.getClientRect(),l,t,i);b&&(t=o.x?.()+o.width?.()+1,d="isWall");var v=!!s&&r(s,s.getClientRect(),l,t,i);v&&(t=s.x?.()-l.width,d="isWall");var y=!!n&&r(n,n.getClientRect(),l,t,i);return y&&(i=n.y?.()+n.height?.()+1,d="isWall"),[[e,t,i,d],c]}function F(e,t,i,a,r,l,o){var n=e.findOne("Rect").getClientRect();l=l+" stackname-"+Math.floor(991*Math.random()+10);var s=G(e,t,i,o),d=[s[0]],c=s[1];"isWall"===d[0][3]&&(t=d[0][1],i=d[0][2]);var u="isWall"===d[0][3]||"isWall"===a?"isWall":"isNotWall",m=r.map(function(a){var r=a[1],l=a[2],o=a[0].findOne("Rect").getClientRect(),s=C(a,o,n,e.x(),e.y()),d=C(a,o,n,t,i);if(d.intersectionResult)switch(!0){case"backWall"===c&&0==s.transform.x:return[a[0],r,i+n.height+1,u];case"rightWall"===c&&0==s.transform.y:return[a[0],t-o.width-1,l,u];case"leftWall"===c&&0==s.transform.y:return[a[0],t+n.width+1,l,u];default:return Math.abs(d.transform.x)<Math.abs(d.transform.y)?d.transform.y<0?[a[0],r,i-o.height-1,u]:[a[0],r,i+n.height+1,u]:d.transform.x<0?[a[0],t-o.width-1,l,u]:[a[0],t+n.width+1,l,u]}}.bind(this));m=m.filter((function(e){return void 0!==e}));var h=[];m.forEach(function(e){var t=e[0],i=e[1],a=e[2],n=r.filter((function(e){return e[0]!==t})),s=F(t,i,a,u,n,l,o);h=h.concat(s)}.bind(this));let g=h.filter((e=>"isWall"===e[3])),f=r.findIndex((t=>t[0].attrs.cargoId===e.attrs.cargoId)),p=[];f>=0?(p=r.slice(),p[f]=[e,t,i,a]):p=r.concat([[e,t,i,a]]);let b=[];if(g.forEach(function(e){p=p.filter((t=>!(t[0].attrs.cargoId===e[0].attrs.cargoId))),b=b.concat(F(e[0],e[1],e[2],"isWall",p,l,o))}.bind(this)),S(h,b),"isWall"===d[0][3]){S(m,h);var v=d;S(v,m),m=v}else S(m,h);return m}function M(e,t,i,a){var r=e.findOne("Rect").getClientRect();let l=a.filter((t=>!(t.attrs.cargoId===e.attrs.cargoId))),o=l.filter((e=>!("truckWall"===e.id()))),n=o.map((e=>[e,C([e,e.x(),e.y(),"isNotWall"],e.findOne("Rect").getClientRect(),r,t,i)])).filter((e=>1==e[1].intersectionResult));return n.map((e=>e[0]))}function P(e,t){var i=e.attrs.cargoId,a=e.findOne("Rect").getClientRect(),r=t.filter((e=>"cargoGroup"===e.id()&&!(e.attrs.cargoId===i))),l=r.map((t=>[t,C([t,t.x(),t.y(),"isNotWall"],t.findOne("Rect").getClientRect(),a,e.x(),e.y())])),o=l.filter((e=>1==e[1].intersectionResult&&e[1].transform.y>0)),n=l.filter((e=>1==e[1].intersectionResult&&e[1].transform.x>0)),s=l.filter((e=>1==e[1].intersectionResult&&e[1].transform.x<0)),d=l.filter((e=>1==e[1].intersectionResult&&e[1].transform.y<0)),c=o.map((e=>[e[0],e[0].y()])).sort(((e,t)=>e[1]>t[1]?1:-1)),u=n.map((e=>[e[0],e[0].x()])).sort(((e,t)=>e[1]>t[1]?1:-1)),m=s.map((e=>[e[0],e[0].x()])).sort(((e,t)=>e[1]<t[1]?1:-1)),h=d.map((e=>[e[0],e[0].y()])).sort(((e,t)=>e[1]<t[1]?1:-1)),g={above:h,below:c,right:u,left:m};return g}function R(e,t){e.forEach((function(e){var i=e[0].attrs.cargoId,a=e[1],r=e[2],l=t.findIndex((e=>e[0].attrs.cargoId===i));l>=0&&(t[l][1]=a,t[l][2]=r)}))}function O(e,t,i){var a=e.attrs.cargoId,r=e.findOne("Rect").getClientRect(),l=t.filter((e=>"cargoGroup"===e.id()&&!(e.attrs.cargoId===a)));l=l.map((e=>[e,e.x(),e.y(),"isNotWall"]));var o=t.find((e=>"backWall"===e.attrs.truckId)),n=t.find((e=>"leftWall"===e.attrs.truckId)),s=t.find((e=>"rightWall"===e.attrs.truckId)),d=o.y()+o.height()-r.height,c=n.x()+n.width()-r.width,u=s.x()+1,m=G(e,e.x(),e.y(),t);function h(i,a,o,n){e.x(i),e.y(a);var s=t;for(let c=0;c<("backWall"===g?r.height+1:r.width+1);c++){switch(g){case"backWall":e.y(e.y()+1),s=t.filter((e=>!("backWall"===e.attrs.truckId)));break;case"leftWall":e.x(e.x()+1),s=t.filter((e=>!("leftWall"===e.attrs.truckId)));break;case"rightWall":e.x(e.x()-1),s=t.filter((e=>!("rightWall"===e.attrs.truckId)));break;default:break}var d=F(e,e.x(),e.y(),"isNotWall",l,"",s);R(d,l),d.forEach((function(e){var t=e[0];t.x(e[1]),t.y(e[2])}))}}if("isNotWall"!==m[1]){var g=m[1],f=m[0][1],p=m[0][2];switch(g){case"backWall":var b=f,v=d;h(b,v,f,p);break;case"leftWall":b=c,v=p;h(b,v,f,p);break;case"rightWall":b=u,v=p;h(b,v,f,p);break;default:break}var y=G(e,e.x(),e.y(),t);let me=t.filter((t=>!(t.attrs.cargoId===e.attrs.cargoId))),he=me.filter((e=>!("truckWall"===e.id()))),ge=he.map((t=>[t,C([t,t.x(),t.y(),"isNotWall"],t.findOne("Rect").getClientRect(),r,e.x(),e.y())])).filter((e=>1==e[1].intersectionResult));if("isNotWall"!==y[1]||ge.length>0){var k=y[1];e.x(),e.y();switch(k){case"backWall":e.y(o.y()-r.height);break;case"leftWall":e.x(n.x()-r.width);break;case"rightWall":e.x(s.x()+s.width()+1);break;default:break}}}else{var x=P(e,t),w=x.above.length+x.below.length+x.left.length+x.right.length;if(w>0){if(x.above.length>0)var I=x.above[0][0],W=x.above[0][1],S=I.findOne("Rect").getClientRect(),O=W+S.height+1,E=G(e,e.x(),O,t)[1],N=t.filter((e=>!(e.attrs.truckId===E))),_=M(e,e.x(),O,t).map((e=>e.attrs.cargoId)),L=l.filter((e=>!_.find((t=>t===e[0].attrs.cargoId)))),D=Math.abs(e.y()-(W+S.height+1));if(x.below.length>0)var U=x.below[0][0],T=x.below[0][1],$=(U.findOne("Rect").getClientRect(),T-r.height-1),V=G(e,e.x(),$,t)[1],z=t.filter((e=>!(e.attrs.truckId===V))),j=M(e,e.x(),$,t).map((e=>e.attrs.cargoId)),B=l.filter((e=>!j.find((t=>t===e[0].attrs.cargoId)))),A=Math.abs(e.y()+r.height+1-T);if(x.left.length>0)var Y=x.left[0][0],K=x.left[0][1],H=Y.findOne("Rect").getClientRect(),X=K+H.width+1,Z=G(e,X,e.y(),t)[1],q=t.filter((e=>!(e.attrs.truckId===Z))),J=M(e,X,e.y(),t).map((e=>e.attrs.cargoId)),Q=l.filter((e=>!J.find((t=>t===e[0].attrs.cargoId)))),ee=Math.abs(e.x()-(K+H.width+1));if(x.right.length>0)var te=x.right[0][0],ie=x.right[0][1],ae=(te.findOne("Rect").getClientRect(),ie-r.width-1),re=G(e,ae,e.y(),t)[1],le=t.filter((e=>!(e.attrs.truckId===re))),oe=M(e,ae,e.y(),t).map((e=>e.attrs.cargoId)),ne=l.filter((e=>!oe.find((t=>t===e[0].attrs.cargoId)))),se=Math.abs(e.x()+r.width+1-ie);function fe(t,i,a,r,l){switch(!0){case"above"===t||"below"===t:e.y(i);break;case"right"===t||"left"===t:e.x(i);break;default:break}for(let u=0;u<a;u++){var o=e.x(),n=e.y();switch(t){case"above":e.y(e.y()-1),D-=1;break;case"below":e.y(e.y()+1),A-=1;break;case"right":e.x(e.x()+1),se-=1;break;case"left":e.x(e.x()-1),ee-=1;break;default:break}var s=F(e,e.x(),e.y(),"isNotWall",r,"",l);R(s,r),s.forEach((function(e){var t=e[0];t.x(e[1]),t.y(e[2])}));var d=e.x(),c=e.y();if(o==d&&n==c)switch(t){case"above":void 0!==A&&(A+=1);break;case"below":void 0!==D&&(D+=1);break;case"right":void 0!==ee&&(ee+=1);break;case"left":void 0!==se&&(se+=1);break;default:break}else switch(t){case"above":void 0!==O&&(O-=1);break;case"below":void 0!==$&&($+=1);break;case"right":void 0!==ae&&(ae+=1);break;case"left":void 0!==X&&(X-=1);break;default:break}}}var de=0;while(D>0||A>0||se>0||ee>0){if((0==Math.trunc(D)||0==Math.trunc(A)||0==Math.trunc(se)||0==Math.trunc(ee))&&(de+=1,20==de))break;for(const pe in x)if(x[pe].length>0)switch(pe){case"above":fe("above",O,D,L,N);break;case"below":fe("below",$,A,B,z);break;case"right":fe("right",ae,se,ne,le);break;case"left":fe("left",X,ee,Q,q);break;default:break}}var ce=M(e,e.x(),e.y(),t),ue=G(e,e.x(),e.y(),t);(ce.length>0||"isNotWall"!==ue[1])&&(e.x(i.x),e.y(i.y))}}}const E=window.innerWidth,N=window.innerHeight;var _={name:"EzLoading",components:{AddDialog:p,TruckDialog:k,PalletKonvaGroup:W},mounted(){this.$refs.stage.getStage().container().style.backgroundColor="#f0f0f0",this.$refs.stage.getStage().container().style.border="2px solid black",window.addEventListener("resize",this.resizeStage),this.resizeStage(),this.truck.originx=this.truckLocationX()},unmounted(){window.removeEventListener("resize",this.resizeStage)},setup(){const{name:e}=(0,c.AW)(),t=(0,r.Fl)((()=>{switch(e.value){case"xs":case"sm":return"mobile";case"md":case"lg":case"xl":case"xxl":return"desktop";default:return"desktop"}}));return{displayWidth:t}},data(){return{drawer:!1,group:null,saveStartDragCoords:{x:0,y:0},dialog:!1,scaleFactor:2,stageConfig:{container:"container",width:E,height:N,scaleX:1,scaleY:1},backingRectConfig:{id:"truckFloor",width:E,height:N,fill:"#ffffcc"},truck:{units:"Imperial",originx:679,originy:10,dimx:102,dimy:576},cargo:[],closeIcon:null,rotateIcon:null}},methods:{prObj(e){return JSON.stringify(e,void 0,2)},prt(e,t){console.log(e+":"),void 0===t?console.log(`${e} is undefined`):console.log(t)},TESTING_BUTTON1(){console.log("button1 clicked"),this.scaleFactor=1.1*this.scaleFactor;this.$refs.layer.getNode().getLayer().children},TESTING_BUTTON2(){console.log("button2 clicked"),this.scaleFactor=this.scaleFactor/1.1},TESTING_BUTTON3(){console.log("button3 clicked"),this.scaleFactor=2},TESTING_findOverlaps(){var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>"cargo-1"===e.attrs.cargoId));M(t,t.x(),t.y(),e)},TESTING_dedupeStackedCargo_dummy(){var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>"cargo-1"===e.attrs.cargoId));P(t,e)},TESTING_pixelPush_dummy(){var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>"cargo-1"===e.attrs.cargoId));O(t,e,this.saveStartDragCoords)},TESTING_Setup1(){console.log("TESTING_Setup1() called"),this.addCargo("Imperial","48.00","40.00"),this.addCargo("Imperial","48.00","40.00")},TESTING_Setup2(){var e=this.$refs.layer.getNode().getLayer().children,t=e.filter((e=>"cargoGroup"===e.id())),i=t[0],a=(i.findOne("Rect").getClientRect(),t[1]);a.findOne("Rect").getClientRect();i.x(280),i.y(130),a.x(430),a.y(170)},TESTING_PrintCargo(){console.table(this.cargo)},TESTING_ForceHighlight(){var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>"cargo-1"===e.attrs.cargoId)),i=t.findOne((e=>"topBorder"===e.id())),a=t.findOne((e=>"bottomBorder"===e.id())),r=t.findOne((e=>"rightBorder"===e.id())),l=t.findOne((e=>"leftBorder"===e.id()));i.stroke("red"),i.shadowEnabled(!1),a.stroke("red"),a.shadowEnabled(!1),r.stroke("red"),r.shadowEnabled(!1),l.stroke("red"),l.shadowEnabled(!1)},processImpactStart(){console.log("processImpactStart called");var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>e.attrs.cargoId===this.cargo[0].id)),i=(t.findOne("Rect").getClientRect(),e.filter((e=>!(e.attrs.cargoId===t.attrs.cargoId)&&!("truckWall"===e.id())&&!("truckFloor"===e.id()))));i=i.map((e=>[e,e.x(),e.y(),"isNotWall"]));var a=F(t,t.x(),t.y(),"isNotWall",i,"",e);console.log("final resolvedArray from processImpactStart()"),console.table(a.map((e=>[e[0].attrs.cargoId,e[1],e[2],e[3]]))),a.forEach((function(e){var t=e[0];t.x(e[1]),t.y(e[2])}))},handleDragStart(e){this.saveStartDragCoords.x=e.target.x(),this.saveStartDragCoords.y=e.target.y()},handleMouseMove(){var e=this.$refs.layer.getNode().getLayer().children;this.cargo.forEach((function(t){var i=e.find((e=>e.attrs.cargoId===t.id));t.x=i.x(),t.y=i.y()}))},isCargoOutside(e,t,i){var a=i[0],r=a.findOne("Rect").getClientRect(),l=e.find((e=>"leftWall"===e.attrs.truckId)),o=e.find((e=>"backWall"===e.attrs.truckId)),n=e.find((e=>"rightWall"===e.attrs.truckId));return a.x()+r.width-1<l.x()||n.x()+n.width()<a.x()||a.y()+r.height<o.y()},guideLinesoldversion(e,t){var i=e.findOne("Rect").getClientRect(),a=e.absolutePosition().x,r=e.absolutePosition().x+i.width,l=e.absolutePosition().y,o=e.absolutePosition().y+i.height,n=t.filter((t=>"cargoGroup"===t.id()&&!(t.attrs.cargoId===e.attrs.cargoId))),s=this.$refs.stage.getStage(),d=this.$refs.layer.getNode().getLayer();function c(e,t){if("vertical"==e){var i=new Konva.Line({points:[t,-6e3,t,6e3],stroke:"rgb(0, 161, 255)",strokeWidth:1,id:e+t,name:"guid-line",dash:[4,6]});d.children.find((i=>"guid-line"===i.name()&&i.id()===e+t))||d.add(i)}else{i=new Konva.Line({points:[-6e3,t,6e3,t],stroke:"rgb(0, 161, 255)",strokeWidth:1,id:e+t,name:"guid-line",dash:[4,6]});d.children.find((i=>"guid-line"===i.name()&&i.id()===e+t))||d.add(i)}}function u(e){var t=e.findOne("Rect").getClientRect(),i={startInterval:e.absolutePosition().x-5,endInterval:e.absolutePosition().x+5,anchor:e.absolutePosition().x-1},a={startInterval:e.absolutePosition().x+t.width-5,endInterval:e.absolutePosition().x+t.width+5,anchor:e.absolutePosition().x+t.width},r={startInterval:e.absolutePosition().y-5,endInterval:e.absolutePosition().y+5,anchor:e.absolutePosition().y-1},l={startInterval:e.absolutePosition().y+t.height-5,endInterval:e.absolutePosition().y+t.height+5,anchor:e.absolutePosition().y+t.height};return{cargoId:e.attrs.cargoId,leftGuide:i,rightGuide:a,aboveGuide:r,belowGuide:l}}var m=n.map((e=>u(e)));m.forEach((function(t){var n=t.leftGuide.startInterval<a&&a<t.leftGuide.endInterval,u=t.leftGuide.startInterval<r&&r<t.leftGuide.endInterval;if(n||u)switch(!0){case n:e.absolutePosition({x:t.leftGuide.anchor+1,y:e.absolutePosition().y}),c("vertical",t.leftGuide.anchor),s.batchDraw();break;case u:e.absolutePosition({x:t.leftGuide.anchor-i.width,y:e.absolutePosition().y}),c("vertical",t.leftGuide.anchor),s.batchDraw();break;default:break}else{var m=d.children.find((e=>"guid-line"===e.name()&&e.id()==="vertical"+t.leftGuide.anchor));m&&m.destroy()}if(n=t.rightGuide.startInterval<a&&a<t.rightGuide.endInterval,u=t.rightGuide.startInterval<r&&r<t.rightGuide.endInterval,n||u)switch(!0){case n:e.absolutePosition({x:t.rightGuide.anchor+1,y:e.absolutePosition().y}),c("vertical",t.rightGuide.anchor),s.batchDraw();break;case u:e.absolutePosition({x:t.rightGuide.anchor-i.width,y:e.absolutePosition().y}),c("vertical",t.rightGuide.anchor),s.batchDraw();break;default:break}else{var h=d.children.find((e=>"guid-line"===e.name()&&e.id()==="vertical"+t.rightGuide.anchor));h&&h.destroy()}var g=t.aboveGuide.startInterval<l&&l<t.aboveGuide.endInterval,f=t.aboveGuide.startInterval<o&&o<t.aboveGuide.endInterval;if(g||f)switch(!0){case g:e.absolutePosition({x:e.absolutePosition().x,y:t.aboveGuide.anchor+1}),c("horizontal",t.aboveGuide.anchor),s.batchDraw();break;case f:e.absolutePosition({x:e.absolutePosition().x,y:t.aboveGuide.anchor-i.height}),c("horizontal",t.aboveGuide.anchor),s.batchDraw();break;default:break}else{var p=d.children.find((e=>"guid-line"===e.name()&&e.id()==="horizontal"+t.aboveGuide.anchor));p&&p.destroy()}g=t.belowGuide.startInterval<l&&l<t.belowGuide.endInterval,f=t.belowGuide.startInterval<o&&o<t.belowGuide.endInterval;if(g||f)switch(!0){case g:e.absolutePosition({x:e.absolutePosition().x,y:t.belowGuide.anchor+1}),c("horizontal",t.belowGuide.anchor),s.batchDraw();break;case f:e.absolutePosition({x:e.absolutePosition().x,y:t.belowGuide.anchor-i.height}),c("horizontal",t.belowGuide.anchor),s.batchDraw();break;default:break}else{var b=d.children.find((e=>"guid-line"===e.name()&&e.id()==="horizontal"+t.belowGuide.anchor));b&&b.destroy()}}))},guideLines(e,t){var i=e.findOne("Rect").getClientRect(),a=e.x(),r=e.x()+i.width,l=e.y(),o=e.y()+i.height,n=t.filter((t=>"cargoGroup"===t.id()&&!(t.attrs.cargoId===e.attrs.cargoId))),s=this.$refs.stage.getStage(),d=this.$refs.layer.getNode().getLayer();function c(e,t){if("vertical"==e){var i=new Konva.Line({points:[t,-6e3,t,6e3],stroke:"rgb(0, 161, 255)",strokeWidth:1,id:e+t,name:"guid-line",dash:[4,6]});d.children.find((i=>"guid-line"===i.name()&&i.id()===e+t))||d.add(i)}else{i=new Konva.Line({points:[-6e3,t,6e3,t],stroke:"rgb(0, 161, 255)",strokeWidth:1,id:e+t,name:"guid-line",dash:[4,6]});d.children.find((i=>"guid-line"===i.name()&&i.id()===e+t))||d.add(i)}}function u(e){var t=e.findOne("Rect").getClientRect(),i={startInterval:e.x()-5,endInterval:e.x()+5,anchor:e.x()-1},a={startInterval:e.x()+t.width-5,endInterval:e.x()+t.width+5,anchor:e.x()+t.width},r={startInterval:e.y()-5,endInterval:e.y()+5,anchor:e.y()-1},l={startInterval:e.y()+t.height-5,endInterval:e.y()+t.height+5,anchor:e.y()+t.height};return{cargoId:e.attrs.cargoId,leftGuide:i,rightGuide:a,aboveGuide:r,belowGuide:l}}var m=n.map((e=>u(e)));m.forEach((function(t){var n=t.leftGuide.startInterval<a&&a<t.leftGuide.endInterval,u=t.leftGuide.startInterval<r&&r<t.leftGuide.endInterval;if(n||u)switch(!0){case n:e.position({x:t.leftGuide.anchor+1,y:e.y()}),c("vertical",t.leftGuide.anchor),s.batchDraw();break;case u:e.position({x:t.leftGuide.anchor-i.width,y:e.y()}),c("vertical",t.leftGuide.anchor),s.batchDraw();break;default:break}else{var m=d.children.find((e=>"guid-line"===e.name()&&e.id()==="vertical"+t.leftGuide.anchor));m&&m.destroy()}if(n=t.rightGuide.startInterval<a&&a<t.rightGuide.endInterval,u=t.rightGuide.startInterval<r&&r<t.rightGuide.endInterval,n||u)switch(!0){case n:e.position({x:t.rightGuide.anchor+1,y:e.y()}),c("vertical",t.rightGuide.anchor),s.batchDraw();break;case u:e.position({x:t.rightGuide.anchor-i.width,y:e.y()}),c("vertical",t.rightGuide.anchor),s.batchDraw();break;default:break}else{var h=d.children.find((e=>"guid-line"===e.name()&&e.id()==="vertical"+t.rightGuide.anchor));h&&h.destroy()}var g=t.aboveGuide.startInterval<l&&l<t.aboveGuide.endInterval,f=t.aboveGuide.startInterval<o&&o<t.aboveGuide.endInterval;if(g||f)switch(!0){case g:e.position({x:e.x(),y:t.aboveGuide.anchor+1}),c("horizontal",t.aboveGuide.anchor),s.batchDraw();break;case f:e.position({x:e.x(),y:t.aboveGuide.anchor-i.height}),c("horizontal",t.aboveGuide.anchor),s.batchDraw();break;default:break}else{var p=d.children.find((e=>"guid-line"===e.name()&&e.id()==="horizontal"+t.aboveGuide.anchor));p&&p.destroy()}g=t.belowGuide.startInterval<l&&l<t.belowGuide.endInterval,f=t.belowGuide.startInterval<o&&o<t.belowGuide.endInterval;if(g||f)switch(!0){case g:e.position({x:e.x(),y:t.belowGuide.anchor+1}),c("horizontal",t.belowGuide.anchor),s.batchDraw();break;case f:e.position({x:e.x(),y:t.belowGuide.anchor-i.height}),c("horizontal",t.belowGuide.anchor),s.batchDraw();break;default:break}else{var b=d.children.find((e=>"guid-line"===e.name()&&e.id()==="horizontal"+t.belowGuide.anchor));b&&b.destroy()}}))},guideWalls(e,t,i){var a=t.filter((e=>"truckWall"===e.id()));if("isNotWall"!==i[1]){var r=t.find((e=>e.attrs.truckId===i[1]));r.fill("red"),a.filter((e=>!(e.attrs.truckId===i[1]))).forEach((e=>e.fill("black")))}else a.forEach((e=>e.fill("black")))},TESTING_guideWalls(){var e=this.$refs.layer.getNode().getLayer().children,t=e.find((e=>"cargo-1"===e.attrs.cargoId));this.guideWalls(t,e)},handleDragMove(e){var t=e.target;if(""!==t.id()){var i=e.target.findOne("Rect").getClientRect(),a=this.$refs.layer.getNode().getLayer().children.filter((e=>!("truckFloor"===e.id())));this.guideLines(t,a);var r=G(t,t.x(),t.y(),a);this.guideWalls(t,a,r);var l=a.filter((e=>"cargoGroup"===e.id()&&!(e.attrs.cargoId===t.attrs.cargoId))),o=l.map((e=>[e,C([e,e.x(),e.y(),"isNotWall"],e.findOne("Rect").getClientRect(),i,t.x(),t.y())]));t.findOne("Rect").opacity(.5),o.forEach(function(e){var i=e[0].findOne((e=>"topBorder"===e.id())),l=e[0].findOne((e=>"bottomBorder"===e.id())),o=e[0].findOne((e=>"rightBorder"===e.id())),n=e[0].findOne((e=>"leftBorder"===e.id()));if(e[1].intersectionResult)switch(!0){case r[1]===(this.isCargoOutside(a,t,e)?"frontWall":"backWall")||"isNotWall"===r[1]&&e[1].transform.y>0:i.stroke("red"),i.shadowEnabled(!0),l.stroke("black"),l.shadowEnabled(!1),o.stroke("black"),o.shadowEnabled(!1),n.stroke("black"),n.shadowEnabled(!1);break;case r[1]===(this.isCargoOutside(a,t,e)?"backWall":"frontWall")||"isNotWall"===r[1]&&e[1].transform.y<0:i.stroke("black"),i.shadowEnabled(!1),l.stroke("red"),l.shadowEnabled(!0),o.stroke("black"),o.shadowEnabled(!1),n.stroke("black"),n.shadowEnabled(!1);break;case r[1]===(this.isCargoOutside(a,t,e)?"leftWall":"rightWall")||"isNotWall"===r[1]&&e[1].transform.x<0:i.stroke("black"),i.shadowEnabled(!1),l.stroke("black"),l.shadowEnabled(!1),o.stroke("red"),o.shadowEnabled(!0),n.stroke("black"),n.shadowEnabled(!1);break;case r[1]===(this.isCargoOutside(a,t,e)?"rightWall":"leftWall")||"isNotWall"===r[1]&&e[1].transform.x>0:i.stroke("black"),i.shadowEnabled(!1),l.stroke("black"),l.shadowEnabled(!1),o.stroke("black"),o.shadowEnabled(!1),n.stroke("red"),n.shadowEnabled(!0);break}else i.stroke("black"),i.shadowEnabled(!1),l.stroke("black"),l.shadowEnabled(!1),o.stroke("black"),o.shadowEnabled(!1),n.stroke("black"),n.shadowEnabled(!1)}.bind(this))}},handlePointerDown(e){e.target.getParent().moveToTop()},handleDragEnd(e){var t=e.target;if(""!==t.id()){var i=this.$refs.layer.getNode().getLayer();i.find(".guid-line").forEach((e=>e.destroy()));var a=i.children.filter((e=>!("truckFloor"===e.id()))),r=a.filter((e=>"truckWall"===e.id()));r.forEach((e=>e.fill("black")));var l=a.filter((e=>!("truckWall"===e.id())&&!("truckFloor"===e.id())));l.forEach((function(e){e.findOne("Rect").opacity(1);var t=e.findOne((e=>"topBorder"===e.id())),i=e.findOne((e=>"bottomBorder"===e.id())),a=e.findOne((e=>"rightBorder"===e.id())),r=e.findOne((e=>"leftBorder"===e.id()));t.stroke("black"),t.shadowEnabled(!1),i.stroke("black"),i.shadowEnabled(!1),a.stroke("black"),a.shadowEnabled(!1),r.stroke("black"),r.shadowEnabled(!1)})),O(t,a,this.saveStartDragCoords)}else t.moveToBottom()},mouseoverPointer(){document.body.style.cursor="pointer"},mouseoutPointer(){document.body.style.cursor="default"},addCargo(e,t,i){var a=(0,u.uniqueId)("cargo-");this.cargo.push({id:a,units:e,dimx:parseFloat(t),dimy:parseFloat(i),x:0,y:0})},loadSpaceSet(e,t,i){this.truck={units:e,originx:this.truck.originx,originy:this.truck.originy,dimx:t,dimy:i},this.resizeStage()},deleteCargo(e,t){this.cargo.splice(t,1),this.mouseoutPointer()},deleteCargoCategory(e){e.value.forEach(function(e){var t=this.cargo.findIndex((t=>t.id===e.id));t>-1&&this.deleteCargo(e,t)}.bind(this))},deleteCargoCategoryItem(e){if(!(e["value"].length<=1)){var t=e["value"][e["value"].length-1],i=t["id"],a=this.cargo.findIndex((e=>e.id===i));a>-1&&this.deleteCargo(t,a)}},rotateCargo(e,t){var i=this.cargo[t].dimx;this.cargo[t].dimx=this.cargo[t].dimy,this.cargo[t].dimy=i},resizeStage(){var e=this.$refs.stage.getStage(),t=document.getElementById("container").parentNode.offsetWidth;e.width(t),e.height(2*window.innerHeight),this.truck.originx=this.truckLocationX()},truckLocationX(){var e,t=this.$refs.stage.getStage(),i=t.width();return"Imperial"===this.truck.units?(e=this.truck.dimx*this.scaleFactor,Math.round((i-(e+20))/2)):(e=.3937*this.truck.dimx*this.scaleFactor,Math.round((i-(e+20))/2))},lowestYBound(){this.$refs.layer.getNode().getLayer().children.forEach((function(e){e.id()}));var e=this.$refs.layer.getNode().getLayer().children,t=e.filter((e=>"cargoGroup"===e.id())),i=t.map((e=>e.y()+e.findOne("Rect").getClientRect().height));return Math.max(...i,0)+1}},computed:{generateNavDrawerList(){var e=(0,u.groupBy)(this.cargo,(e=>[e.units,e.dimx,e.dimy])),t=Object.entries(e).map((e=>[e[0].split(","),e[1]])),i=Object.entries(t).map((e=>[[e[1][0][0],parseInt(e[1][0][1]),parseInt(e[1][0][2])],e[1][1]])),a=(0,u.orderBy)(i,[e=>e[0][0],e=>e[0][1],e=>e[0][2],["asc","asc","asc"]]),r=a.map((e=>({title:`${e[0][1]}${"Imperial"===e[0][0]?"in":"cm"} x ${e[0][2]}${"Imperial"===e[0][0]?"in":"cm"}`,value:e[1]})));return r}},watch:{group(){this.drawer=!1}}};const L=(0,g.Z)(_,[["render",d],["__scopeId","data-v-6e50404e"]]);var D=L,U={name:"App",components:{EzLoading:D}};const T=(0,g.Z)(U,[["render",l]]);var $=T,V=i(3571),z=i.n(V),j=(i(9773),i(8727)),B=i(3447),A=i(8600);const Y=(0,j.Rd)({components:B,directives:A}),K=(0,a.ri)($);K.use(z()),K.use(Y),K.mount("#app")}},t={};function i(a){var r=t[a];if(void 0!==r)return r.exports;var l=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(l.exports,l,l.exports,i),l.loaded=!0,l.exports}i.m=e,function(){var e=[];i.O=function(t,a,r,l){if(!a){var o=1/0;for(c=0;c<e.length;c++){a=e[c][0],r=e[c][1],l=e[c][2];for(var n=!0,s=0;s<a.length;s++)(!1&l||o>=l)&&Object.keys(i.O).every((function(e){return i.O[e](a[s])}))?a.splice(s--,1):(n=!1,l<o&&(o=l));if(n){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[a,r,l]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,l,o=a[0],n=a[1],s=a[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(r in n)i.o(n,r)&&(i.m[r]=n[r]);if(s)var c=s(i)}for(t&&t(a);d<o.length;d++)l=o[d],i.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return i.O(c)},a=self["webpackChunkezloading"]=self["webpackChunkezloading"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(5809)}));a=i.O(a)})();
//# sourceMappingURL=app.ac15e135.js.map